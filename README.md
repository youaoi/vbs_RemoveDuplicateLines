# CSV をドラッグすると重複行を削除してくれるヤツ (CSV Duplicate Row Remover)

## 概要

この VBScript は、CSV ファイルをドラッグ＆ドロップするだけで、**重複した行を削除**し、ユニークな行だけを抽出した新しい CSV ファイルを作成します。

## ✨ 特徴

- **簡単な操作**: CSV ファイルをスクリプトのアイコンにドラッグ＆ドロップするだけで実行できます。
- **ヘッダー行対応**: 1 行目のヘッダー行は重複判定の対象とせず、必ず出力ファイルに含めます。
- **完全一致判定**: 行全体（カンマやスペースを含む）が**一文字一句違わず完全に一致する行**を重複として削除します。
- **結果レポート**: 処理後、「読み込んだ行数」「ユニークな行数」「削除した行数」をメッセージボックスでお知らせします。

## ⚙️ 動作環境

- Windows (VBScript が動作する環境)

## 🚀 使い方

1. リポジトリから `RemoveDuplicateLines.vbs` ファイルをダウンロードします。
   （もしくは、コードをコピーしてメモ帳などに貼り付けます）
2. **（重要）** もしコードをコピーしてファイルを作成する場合は、メモ帳などで「名前を付けて保存」する際に、**文字コードを `ANSI` に指定して**保存してください。
   - `UTF-8` のまま保存すると、スクリプト実行時にエラーが発生する可能性があります。
3. 重複行を削除したい CSV ファイル（1 つ）を、保存した `RemoveDuplicateLines.vbs` のアイコン上にドラッグ＆ドロップします。
4. 処理が完了すると完了メッセージが表示されます。
5. 元の CSV ファイルと同じフォルダに `(元のファイル名)_unique.csv` という名前で、重複が削除されたファイルが作成されます。

## ⚠️ 注意事項

- **判定基準**: 「特定の列（例：UID の列）が同じ」ではなく、「行全体が文字列として完全に一致する」場合にのみ重複とみなします。大文字・小文字も区別されます。
- **文字コード**: このスクリプトは、CSV ファイルが OS の標準文字コード（日本語環境では `Shift_JIS` / `ANSI`）であることを前提としています。`UTF-8` などの CSV ファイルでは正しく動作しない可能性があります。
- **ファイルサイズ**: 非常に巨大なファイル（数 GB など）を処理する場合、`Dictionary`オブジェクトがメモリを大量に消費し、処理が遅くなったりエラーになったりする可能性があります。
- **複数ファイル**: 一度にドラッグ＆ドロップできるファイルは 1 つだけです。

## 🛠️ 仕組み

内部的に `Scripting.Dictionary` オブジェクトを使用しています。

1. 1 行目のヘッダー行を読み込み、そのまま出力ファイルに書き込み、`Dictionary` にもキーとして登録します。
2. 2 行目以降、1 行ずつ CSV から文字列（`line`）として読み込みます。
3. `Dictionary.Exists(line)` を使って、その行が既に `Dictionary` に存在するか（＝過去に出現したか）をチェックします。
4. 存在しない（ユニークな）行だった場合のみ、`Dictionary` にキーとして登録し、出力ファイルに書き込みます。
5. 既に存在した（重複した）行は、何もせずスキップします。

## 📄 ライセンス (License)

このプロジェクトは [MIT License](LICENSE) の下で公開されています。
